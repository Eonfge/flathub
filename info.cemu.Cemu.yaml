app-id: info.cemu.Cemu
runtime: org.gnome.Platform
runtime-version: '42'
sdk: org.gnome.Sdk

command: slade
finish-args:
  - --device=dri
  - --socket=x11
  - --share=ipc
  - --socket=pulseaudio

# Base editor requirements
  - --filesystem=home

# required for start page
  - --share=network

cleanup:
  - /app/include
  - /app/lib/*.a
  - /app/lib/*.la
  - /app/lib/pkgconfig
 
  
sdk-extensions:
  - org.freedesktop.Sdk.Extension.llvm12
  
build-options:
  prefix: /usr/lib/sdk/ldc
  prepend-path: /usr/lib/sdk/llvm12/bin
  prepend-ld-library-path: /usr/lib/sdk/llvm12/lib

modules:

  # Required so we can use wxWidgets with openGL integration
  - shared-modules/glu/glu-9.json
  - shared-modules/glew/glew.json

  # Dependency that vcpkg is trying to reel in
  # https://github.com/cemu-project/Cemu/tree/main/dependencies/vcpkg_overlay_ports/wxwidgets
  - name: wxwidgets
    buildsystem: autotools
    sources:
      - type: git
        url: https://github.com/wxWidgets/wxWidgets
        tag: v3.2.0
        commit: 5b5ec3804a31a3765d60ff351bbdf79eddb1e1f9
        x-checker-data:
          type: anitya
          project-id: 5150
          stable-only: true
          tag-template: v$version

  # Dependency that vcpkg is trying to reel in
  # https://github.com/cemu-project/Cemu/tree/main/dependencies/vcpkg_overlay_ports/fmt
  - name: fmt
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: https://github.com/fmtlib/fmt/archive/refs/tags/7.1.3.tar.gz
        sha256: 5cae7072042b3043e12d53d50ef404bbb76949dad1de368d7f993a15c8c05ecc
        x-checker-data:
          type: anitya
          project-id: 11526
          url-template: https://github.com/fmtlib/fmt/archive/refs/tags/$version.tar.gz   
          versions:
            <: '7.1.4'         
            
  - name: cemu
    buildsystem: cmake-ninja
    builddir: true
    build-options:    
      env:
        CC: clang
        CXX: clang++
        AR: llvm-ar
        RANLIB: llvm-ranlib
      ldflags: -fuse-ld=lld
      prepend-ld-library-path: /usr/lib/sdk/llvm12/lib
      prepend-path: /usr/lib/sdk/llvm12/bin
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DENABLE_VCPKG=false
    sources:
      - type: git
        url: https://github.com/cemu-project/Cemu
        tag: v2.0-1
        commit: e5d7d5d1736019d08e1ff8d9bd2e385330c5b7de
      - type: git
        dest: 3rdparty/imgui/imgui
        url: https://github.com/ocornut/imgui.git
        commit: 60bea052a92cbb4a93b221002fdf04f0da3698e1
  
