app-id: org.kde.Kid3
runtime: org.kde.Platform
runtime-version: "5.14"
sdk: org.kde.Sdk
command: kid3

#rename-desktop-file: flacon.desktop
#rename-icon: flacon

finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --socket=x11
  - --share=ipc
  - --device=dri

  # Required to load music metadata
  - --share=network

  # Required for input-output
  # Flacon uses some advanced file scanning techniques
  # not compatible with portals
  - --filesystem=xdg-download
  - --filesystem=xdg-music
  - --env=TMPDIR=/var/tmp

cleanup:
  - /man
  - /include
  - /share/man
  - /share/doc
  - /include
  - /lib/*.a
  - /lib/*.la

modules:

- name: xpath
  buildsystem: simple
  build-commands:
    - perl Makefile.PL
    - make
    - make install DESTDIR=/app
  sources:
    - type: archive
      url: https://github.com/manwar/XML-XPath/archive/v1.44.tar.gz
      sha256: 19d5318eaba8434ea529c6bd8eb98947c451ce86f4f595b55b463fc70a480c3c
      
- name: docbook
  buildsystem: simple
  build-commands:
    - make
  sources:
    - type: archive
      url: https://github.com/docbook/xslt10-stylesheets/archive/snapshot/2019-10-05-bobs.tar.gz
      sha256: 27d3893d6f974204273f70c9261327915fd27a33d77ecaf1208c8e4bf63310c4

- name: kid3
  buildsystem: cmake-ninja
  config-opts:
  - -DCMAKE_BUILD_TYPE=RelWithDebInfo
  - -WITH_APPS="Qt;CLI"
  sources:
    - type: archive
      url: https://invent.kde.org/kde/kid3/-/archive/v3.8.2/kid3-v3.8.2.tar.gz
      sha256: f1800fe9a491078e5f362215d0e2568be8b404ad99f6b86d17774cedb9d1ef9e

